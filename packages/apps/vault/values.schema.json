{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Vault wrapper values",
  "properties": {
    "vault": {
      "type": "object",
      "description": "Values forwarded to the upstream Vault chart.",
      "properties": {
        "nameOverride": {
          "type": "string",
          "default": "",
          "description": "Override the chart name for resource naming."
        },
        "fullnameOverride": {
          "type": "string",
          "default": "",
          "description": "Override the full release name."
        },
        "server": {
          "type": "object",
          "description": "Vault server configuration forwarded to the upstream chart.",
          "properties": {
            "ha": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true,
                  "description": "Enable high availability mode."
                },
                "replicas": {
                  "type": "integer",
                  "minimum": 1,
                  "default": 3,
                  "description": "Number of Vault pods to run in HA mode."
                },
                "raft": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean",
                      "default": true,
                      "description": "Use integrated storage via Raft."
                    },
                    "setNodeId": {
                      "type": "boolean",
                      "default": true,
                      "description": "Set deterministic Raft node IDs."
                    },
                    "config": {
                      "type": "string",
                      "default": "ui = true\nlistener \"tcp\" {\n  address = \"[::]:8200\"\n  cluster_address = \"[::]:8201\"\n  tls_disable = \"true\"\n}\nstorage \"raft\" {\n  path = \"/vault/data\"\n}\nservice_registration \"kubernetes\" {}\n",
                      "description": "Raw Vault configuration to bootstrap Raft storage."
                    }
                  }
                }
              }
            },
            "dataStorage": {
              "type": "object",
              "description": "Persistent volume settings for Vault data.",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "size": {
                  "type": "string",
                  "default": "20Gi"
                },
                "storageClass": {
                  "type": "string",
                  "default": ""
                },
                "accessMode": {
                  "type": "string",
                  "default": "ReadWriteOnce"
                }
              }
            },
            "auditStorage": {
              "type": "object",
              "description": "Persistent volume settings for Vault audit logs.",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": false
                },
                "size": {
                  "type": "string",
                  "default": "10Gi"
                },
                "storageClass": {
                  "type": "string",
                  "default": ""
                },
                "accessMode": {
                  "type": "string",
                  "default": "ReadWriteOnce"
                }
              }
            },
            "service": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true,
                  "description": "Expose the Vault service."
                },
                "type": {
                  "type": "string",
                  "default": "ClusterIP",
                  "description": "Kubernetes Service type for Vault."
                },
                "port": {
                  "type": "integer",
                  "default": 8200,
                  "description": "Service port for the Vault API."
                }
              }
            },
            "ingress": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": false,
                  "description": "Create an ingress for Vault UI/API."
                },
                "ingressClassName": {
                  "type": "string",
                  "default": "",
                  "description": "IngressClass to use."
                },
                "annotations": {
                  "type": "object",
                  "additionalProperties": { "type": "string" },
                  "default": {},
                  "description": "Annotations applied to the ingress."
                },
                "hosts": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["host"],
                    "properties": {
                      "host": { "type": "string" },
                      "paths": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "path": { "type": "string", "default": "/" },
                            "pathType": { "type": "string", "default": "Prefix" }
                          }
                        },
                        "default": []
                      }
                    }
                  },
                  "default": []
                },
                "tls": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "hosts": {
                        "type": "array",
                        "items": { "type": "string" },
                        "default": []
                      },
                      "secretName": { "type": "string", "default": "" }
                    }
                  },
                  "default": []
                }
              }
            },
            "resources": {
              "type": "object",
              "properties": {
                "requests": {
                  "type": "object",
                  "properties": {
                    "cpu": { "type": "string", "default": "500m" },
                    "memory": { "type": "string", "default": "1Gi" }
                  }
                },
                "limits": {
                  "type": "object",
                  "properties": {
                    "cpu": { "type": "string", "default": "1" },
                    "memory": { "type": "string", "default": "2Gi" }
                  }
                }
              }
            },
            "nodeSelector": {
              "type": "object",
              "additionalProperties": { "type": "string" },
              "default": {}
            },
            "tolerations": {
              "type": "array",
              "items": { "type": "object" },
              "default": []
            },
            "affinity": {
              "type": "object",
              "default": {},
              "description": "Pod affinity and anti-affinity rules."
            },
            "extraEnvironmentVars": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "value": { "type": "string" }
                },
                "required": ["name", "value"]
              },
              "default": [],
              "description": "Additional environment variables for Vault pods."
            },
            "extraVolumes": {
              "type": "array",
              "items": { "type": "object" },
              "default": []
            },
            "extraVolumeMounts": {
              "type": "array",
              "items": { "type": "object" },
              "default": []
            }
          }
        },
        "injector": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable the Vault Agent Injector webhook."
            },
            "replicas": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "description": "Number of injector webhook replicas."
            },
            "webhook": {
              "type": "object",
              "properties": {
                "failurePolicy": {
                  "type": "string",
                  "default": "Ignore",
                  "description": "Admission webhook failure policy."
                }
              }
            },
            "resources": {
              "type": "object",
              "properties": {
                "requests": {
                  "type": "object",
                  "properties": {
                    "cpu": { "type": "string", "default": "100m" },
                    "memory": { "type": "string", "default": "128Mi" }
                  }
                },
                "limits": {
                  "type": "object",
                  "properties": {
                    "cpu": { "type": "string", "default": "500m" },
                    "memory": { "type": "string", "default": "256Mi" }
                  }
                }
              }
            }
          }
        },
        "csi": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false,
              "description": "Enable the Vault CSI provider."
            },
            "driver": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "default": "secrets.csi.k8s.io",
                  "description": "Name of the CSI driver."
                }
              }
            },
            "agent": {
              "type": "object",
              "properties": {
                "replicas": {
                  "type": "integer",
                  "minimum": 1,
                  "default": 1,
                  "description": "Number of CSI agent replicas."
                }
              }
            }
          }
        }
      }
    }
  }
}
